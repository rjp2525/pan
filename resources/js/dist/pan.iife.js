(function(){"use strict";window.__pan=window.__pan||{csrfToken:"%_PAN_CSRF_TOKEN_%",routePrefix:"%_PAN_ROUTE_PREFIX_%",observer:null,clickListener:null,mouseoverListener:null,inertiaStartListener:null},window.__pan.observer&&(window.__pan.observer.disconnect(),window.__pan.observer=null),window.__pan.clickListener&&(document.removeEventListener("click",window.__pan.clickListener),window.__pan.clickListener=null),window.__pan.mouseoverListener&&(document.removeEventListener("mouseover",window.__pan.mouseoverListener),window.__pan.mouseoverListener=null),window.__pan.inertiaStartListener&&(document.removeEventListener("inertia:start",window.__pan.inertiaStartListener),window.__pan.inertiaStartListener=null),function(){const m=e=>{const t=new MutationObserver(e);t.observe(document.body,{childList:!0,subtree:!0,attributes:!0}),window.__pan.observer=t};let i=[],l=null,r=[],s=[],u=[],c=[];const d=()=>{if(i.length===0)return;const e=i.slice();i=[],navigator.sendBeacon(`/${window.__pan.routePrefix}/events`,new Blob([JSON.stringify({events:e,_token:window.__pan.csrfToken})],{type:"application/json"}))},_=function(){l&&clearTimeout(l),l=setTimeout(d,1e3)},w=function(e,t){const a=e.target.closest("[data-pan]");if(a===null)return;const o=a.getAttribute("data-pan");if(o!==null){if(t==="hover"){if(s.includes(o))return;s.push(o)}if(t==="click"){if(u.includes(o))return;u.push(o)}i.push({type:t,name:o}),_()}},p=function(){document.querySelectorAll("[data-pan]").forEach(t=>{if(t.checkVisibility!==void 0&&!t.checkVisibility())return;const n=t.getAttribute("data-pan");if(n===null)return;let a=document.querySelectorAll(`[data-pan='${n}']`);a.length>1&&!c.includes(n)&&(console.warn(`PAN: Multiple (${a.length}) elements with the same name '${n}' found`),c.push(n)),!r.includes(n)&&(r.push(n),i.push({type:"impression",name:n}))}),_()};m(function(){r.forEach(e=>{document.querySelector(`[data-pan='${e}']`)===null&&(r=r.filter(n=>n!==e),s=s.filter(n=>n!==e),u=u.filter(n=>n!==e))}),p()}),window.__pan.clickListener=e=>w(e,"click"),document.addEventListener("click",window.__pan.clickListener),window.__pan.mouseoverListener=e=>w(e,"hover"),document.addEventListener("mouseover",window.__pan.mouseoverListener),window.__pan.inertiaStartListener=e=>{r=[],s=[],u=[],p()},document.addEventListener("inertia:start",window.__pan.inertiaStartListener),window.__pan.beforeUnloadListener=function(e){i.length!==0&&d()},window.addEventListener("beforeunload",window.__pan.beforeUnloadListener)}()})();
